<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <title>VRSpace:World Editor</title>
    ﻿<style type="text/css">
    html, body {
      width: 100%;
      height:100%;
      margin: 0px;
      padding: 0px;
      color: white;
    }
    canvas {
      width: 98%;
      height:96%;
      padding-left: 0;
      padding-right: 0;
      margin-left: auto;
      margin-right: auto;
      display: block;
    }
    </style>﻿
    
    <script src="https://cdn.babylonjs.com/babylon.js"></script>
    <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
    <script src="https://cdn.babylonjs.com/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"></script>
    <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>
    <script src="/babylon/js/lib/pep.min.js"></script>
  </head>

  <body>

    <canvas id="renderCanvas" touch-action="none"></canvas>

<script>
var canvas = document.getElementById("renderCanvas"); // Get the canvas element
var engine = new BABYLON.Engine(canvas, true); // Generate the BABYLON 3D engine
var myScene;

import("./world-editor.js").then( (module) =>{
  
  var world = module.WORLD;

  world.init(engine, 'search').then((scene) => {
	  myScene = scene;
    
    document.getElementById('searchText').addEventListener('change', (e)=>{
    	console.log('search: '+e.target.value);
      canvas.focus();
      
      var url = new URL('https://api.sketchfab.com/v3/search');
      /*
      interesting params:
        categories - dropdown, radio? Array[string]
        downloadable
        animated
        rigged
        license: by = CC-BY, sketchfab default
      */
      var params = { 
    		  q:e.target.value,
          type:'models',
          downloadable:true
    	};
      url.search = new URLSearchParams(params).toString();

      world.doFetch(url);      
    });
    
  });

})

window.addEventListener("resize", function () {
    engine.resize();
});

function debugOnOff() {
  console.log("Debug: "+myScene.debugLayer.isVisible());
  if ( myScene.debugLayer.isVisible() ) {
    myScene.debugLayer.hide();
  } else {
    myScene.debugLayer.show();
  }
}

</script>

    <div style="position:absolute;bottom:10px;right:50%;">
      <button onClick="debugOnOff()">Debug</button>
    </div>
    
    <div id="searchForm" style="position:absolute;bottom:50px;right:45%;">
      <label for="searchText">Search:</label>
      <input id="searchText" type="text">
    </div>
  
  </body>

</html>
